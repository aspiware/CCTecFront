<ModalStack dismissEnabled="true" class="modal-root">
  <GridLayout rows="*" columns="*">
    <StackLayout row="0" col="0" class="backdrop" (tap)="closeModal()"></StackLayout>

    <GridLayout row="0" col="0" rows="auto,*" class="modal-card">
      <GridLayout row="0" columns="*,auto" class="header header-fixed">
        <Label col="0" text="WiFi Config" class="title modal-title-text"></Label>

        <StackLayout col="1">
          <MenuButton [useSFIcon]="true" style="background-color: transparent; height: 24; width: 35;"
            [sfIconName]="'ellipsis.circle'" [showSpinner]="viewReady && isLoading" #menuStatus [options]="mainMenuOptions"
            (selected)="onSelectedMainMenu($event, menuStatus)">
          </MenuButton>
        </StackLayout>
      </GridLayout>

      <ScrollView row="1" class="form-scroll">
      <StackLayout class="content">
        <StackLayout orientation="horizontal" verticalAlignment="center" horizontalAlignment="center" >
          <ListPicker #devicePicker [items]="deviceLabels" [selectedIndex]="selectedIndex"
            (selectedIndexChange)="onchange($event)" [height]="70" width="70%">
          </ListPicker>
        </StackLayout>

        <StackLayout [formGroup]="wifiConfigForm">
          <StackLayout *ngIf="useSameForAll" formGroupName="primary">
            <!-- <GridLayout rows="auto" columns="400, *" style="margin-bottom: 8;"> -->
              <StackLayout orientation="horizontal">
                <MenuButton [useSFIcon]="true" style="background-color: transparent; height: 35; width: 40;"
                  [sfIconName]="'lock.shield'" [options]="securityMenuOptions(0)"
                  (selected)="onSecuritySelected(0, $event)">
                </MenuButton>
                <Label [text]="bandTitle(0)" class="band-title" style="font-size: 16;"></Label>
              </StackLayout>
              
            <!-- </GridLayout> -->
          <GridLayout columns="*,auto" class="input-shell">
            <TextField col="0" formControlName="name" hint="Name" class="custom-tf-inline" [isEnabled]="hasWifiConfigData"></TextField>
            <Label
              col="1"
              class="copy-icon"
              [class.copy-icon-disabled]="!hasWifiConfigData || !canCopyField(wifiConfigForm.get('primary.name')?.value)"
              [isUserInteractionEnabled]="hasWifiConfigData && canCopyField(wifiConfigForm.get('primary.name')?.value)"
              [class.fas]="isFieldCopied('primary-name')"
              [class.far]="!isFieldCopied('primary-name')"
              [text]="isFieldCopied('primary-name') ? '&#xf00c;' : '&#xf0c5;'"
              (tap)="copyFieldValue(wifiConfigForm.get('primary.name')?.value, 'Name', 'primary-name')">
            </Label>
          </GridLayout>
          <GridLayout columns="*,auto" class="input-shell">
            <TextField col="0" formControlName="password" hint="Password" class="custom-tf-inline" [isEnabled]="hasWifiConfigData"></TextField>
            <Label
              col="1"
              class="copy-icon"
              [class.copy-icon-disabled]="!hasWifiConfigData || !canCopyField(wifiConfigForm.get('primary.password')?.value)"
              [isUserInteractionEnabled]="hasWifiConfigData && canCopyField(wifiConfigForm.get('primary.password')?.value)"
              [class.fas]="isFieldCopied('primary-password')"
              [class.far]="!isFieldCopied('primary-password')"
              [text]="isFieldCopied('primary-password') ? '&#xf00c;' : '&#xf0c5;'"
              (tap)="copyFieldValue(wifiConfigForm.get('primary.password')?.value, 'Password', 'primary-password')">
            </Label>
          </GridLayout>
          </StackLayout>

          <StackLayout *ngIf="!useSameForAll && bandsControls.length > 0" style="margin-top: 10;">
            <SegmentedBar
              [items]="bandSegments"
              [selectedIndex]="selectedBandIndex"
              (selectedIndexChange)="onBandSegmentChanged($event)" style="margin-left: 15">
            </SegmentedBar>

            <StackLayout *ngIf="selectedBandGroup as group" [formGroup]="group" style="margin-top: 10;">
              <StackLayout orientation="horizontal">
                <MenuButton [useSFIcon]="true" style="background-color: transparent; height: 35; width: 40;"
                  [sfIconName]="'lock.shield'" [options]="securityMenuOptions(selectedBandIndex)"
                  (selected)="onSecuritySelected(selectedBandIndex, $event)">
                </MenuButton>
                <Label [text]="bandTitle(selectedBandIndex)" class="band-title" style="font-size: 16;"></Label>
              </StackLayout>

              <GridLayout columns="*,auto" class="input-shell">
                <TextField col="0" formControlName="name" hint="Name" class="custom-tf-inline" [isEnabled]="hasWifiConfigData"></TextField>
                <Label
                  col="1"
                  class="copy-icon"
                  [class.copy-icon-disabled]="!hasWifiConfigData || !canCopyField(group.get('name')?.value)"
                  [isUserInteractionEnabled]="hasWifiConfigData && canCopyField(group.get('name')?.value)"
                  [class.fas]="isFieldCopied('band-name-' + selectedBandIndex)"
                  [class.far]="!isFieldCopied('band-name-' + selectedBandIndex)"
                  [text]="isFieldCopied('band-name-' + selectedBandIndex) ? '&#xf00c;' : '&#xf0c5;'"
                  (tap)="copyFieldValue(group.get('name')?.value, 'Name', 'band-name-' + selectedBandIndex)">
                </Label>
              </GridLayout>
              <GridLayout columns="*,auto" class="input-shell">
                <TextField col="0" formControlName="password" hint="Password" class="custom-tf-inline" [isEnabled]="hasWifiConfigData"></TextField>
                <Label
                  col="1"
                  class="copy-icon"
                  [class.copy-icon-disabled]="!hasWifiConfigData || !canCopyField(group.get('password')?.value)"
                  [isUserInteractionEnabled]="hasWifiConfigData && canCopyField(group.get('password')?.value)"
                  [class.fas]="isFieldCopied('band-password-' + selectedBandIndex)"
                  [class.far]="!isFieldCopied('band-password-' + selectedBandIndex)"
                  [text]="isFieldCopied('band-password-' + selectedBandIndex) ? '&#xf00c;' : '&#xf0c5;'"
                  (tap)="copyFieldValue(group.get('password')?.value, 'Password', 'band-password-' + selectedBandIndex)">
                </Label>
              </GridLayout>
            </StackLayout>
          </StackLayout>

          <GridLayout columns="auto,12,*" class="use-same-row">
            <Switch
              col="0"
              class="use-same-switch"
              [checked]="useSameForAll"
              [isEnabled]="hasWifiConfigData"
              (checkedChange)="onUseSameChanged($event)">
            </Switch>
            <Label col="2" class="use-same-label" text="Use same credentials for all bands"></Label>
          </GridLayout>
        </StackLayout>

      </StackLayout>
      </ScrollView>
    </GridLayout>
  </GridLayout>
</ModalStack>
